<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Вибір пісень для весілля</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 1rem;
        }
        .song-item {
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
        }
        .song-item:hover {
            background-color: #e5e7eb;
        }
        .song-item.selected {
            background-color: #fde68a;
            opacity: 1 !important;
        }
        .song-item.selected:hover {
            background-color: #fcd34d;
        }
        .song-item.highlighted {
            order: -1;
        }
        .custom-checkbox {
            width: 1.5rem;
            height: 1.5rem;
            border: 2px solid #6b7280;
            border-radius: 0.25rem;
            display: inline-block;
            margin-right: 1rem;
            position: relative;
        }
        .custom-checkbox.checked::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0.5rem;
            height: 0.8rem;
            border: solid #b45309;
            border-width: 0 3px 3px 0;
            transform: translate(-50%, -60%) rotate(45deg);
        }
        .scroll-button {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            background-color: #f59e0b;
            color: white;
            padding: 1rem;
            border-radius: 9999px;
            font-weight: bold;
            box-shadow: 0 4px 14px rgba(0, 0, 0, 0.25);
            cursor: pointer;
            z-index: 100;
            transition: all 0.2s ease-in-out;
            text-align: center;
        }
        .scroll-button:hover {
            background-color: #d97706;
            transform: translateY(-2px);
        }
        .scroll-button.bg-red-500 {
            background-color: #ef4444;
        }
        .scroll-button.bg-red-500:hover {
            background-color: #dc2626;
        }
        .counter-red {
            color: #ef4444;
        }
        .icon {
            width: 2rem;
            height: 2rem;
            margin-left: 0.5rem;
            vertical-align: middle;
            display: inline-block;
        }
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #e5e7eb;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #9ca3af;
            border-radius: 10px;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

<div class="w-full max-w-[900px] mx-auto flex flex-col space-y-4">
    <div class="content-wrapper p-6">
        <h1 class="text-4xl lg:text-5xl font-extrabold text-center mb-2 text-amber-600">Плейлист для вашого свята</h1>
        <p class="text-center text-lg text-gray-500 mb-6">Оберіть до 50 пісень, які Ви хочете почути на вашому весіллі</p>

        <div class="mb-8">
            <input type="text" id="searchInput" placeholder="Пошук пісні або виконавця..." class="w-full p-4 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-amber-500 transition-all duration-200">
        </div>

        <div id="songList" class="flex flex-col">
            </div>

        <div id="selectedSongsSection" class="mt-12 pt-8 border-t-2 border-gray-200">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-3xl lg:text-4xl font-bold text-amber-600">Обрані пісні</h2>
                <div class="flex items-center space-x-4">
                    <button id="undoButton" class="w-10 h-10 p-2 bg-gray-200 text-gray-700 font-medium rounded-full shadow-md hover:bg-gray-300 transition-colors duration-200 opacity-50 flex items-center justify-center" disabled>
                        <i class="fa-solid fa-arrow-rotate-left"></i>
                    </button>
                    <div id="selectedCounterTop" class="text-2xl font-bold">
                        <span class="text-amber-600">0</span>/<span class="text-gray-500">50</span>
                    </div>
                </div>
            </div>

            <button id="copyButton" class="w-full py-3 bg-amber-500 text-white font-bold rounded-lg shadow-lg hover:bg-amber-600 transition-colors duration-200 mb-6">
                Скопіювати список
            </button>

            <div id="selectedListContainer">
                <p id="emptySelectedMessage" class="text-center text-gray-500 text-lg">
                    Оберіть пісні, щоб вони з'явились тут.
                </p>
            </div>
        </div>
    </div>

    <button id="scrollButton" class="scroll-button">
        <span id="selectedCounterBottom" class="text-lg">0/50</span>
        <i class="fas fa-music block mt-1"></i>
    </button>
</div>

<script>
    const allSongs = [
        // Українські - Народні
            { id: 'ukr-folk-1', title: "7-40", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-2', title: "Ой на горі два дубки", artist: "Mad Heads", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-3', title: "Смерека", artist: "Mad Heads", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-4', title: "Ой у лузі червона калина", artist: "Бумбокс", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-5', title: "Ти ж мене підманула", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-6', title: "А зорі, а зорі", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-7', title: "А я все дивлюся, де ж моя Маруся", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-8', title: "За нашов стодолов", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-9', title: "Лілія", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-10', title: "Нині, нині", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-11', title: "Ой, там у Львові", artist: "Джазова фіра", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-12', title: "Плакуча Гітара", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-13', title: "Сиджу я край віконечка", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-14', title: "Сині фіалки", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-15', title: "Стожари", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-16', title: "Там під Львівським замком", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-17', title: "Тернопільські каштани", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-18', title: "Ти ж мене підманула", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-19', title: "Тиха вода", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-20', title: "Цвіте терен", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-21', title: "Час рікою пливе", artist: "Народна", category: "Українські", subcategory: "Народні" },
            { id: 'ukr-folk-22', title: "Чорні очка, як терен", artist: "Джазова фіра", category: "Українські", subcategory: "Народні" },

            // Українські - Поп
            { id: 'ukr-pop-1', title: "Повільно", artist: "ADAM", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-2', title: "Особистий рай", artist: "Adam & Геля Зозуля", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-3', title: "Твоя ", artist: "Alena Omargalieva", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-4', title: "Гарно так", artist: "CHEEV", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-5', title: "Покохай мене", artist: "Chico, Qatoshi & 100лиця", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-6', title: "Хочеш", artist: "DIBROVA & ОЛЕНА ТОПОЛЯ", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-7', title: "Кохаю, але не зовсім", artist: "DOROFEEVA", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-8', title: "Спитай у чата джипіті", artist: "DOROFEEVA", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-9', title: "Смарагдове небо", artist: "DREVO", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-10', title: "Вихідний", artist: "DZIDZIO", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-11', title: "Моя любов", artist: "DZIDZIO", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-12', title: "Я і Сара", artist: "DZIDZIO", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-13', title: "Василина", artist: "DZIDZIO & Іван Попович", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-14', title: "Розлук не буде", artist: "DZIDZIO feat Іван Попович", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-15', title: "Киця", artist: "DZIDZIO & Оля Цибульська", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-16', title: "Цьомаю", artist: "DZIDZIO & Оля Цибульська", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-17', title: "Охрана отмєна ", artist: "Jerry Heil", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-18', title: "Додому", artist: "Kalush", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-19', title: "Плакала", artist: "KAZKA", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-20', title: "Свята", artist: "KAZKA", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-21', title: "Чи разом", artist: "KOLA", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-22', title: "Люди", artist: "KOLA & MamaRika", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-23', title: "Така спокуслива", artist: "KOLA & MamaRika", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-24', title: "Береги UA", artist: "Max Barskih", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-25', title: "Тумани UA", artist: "Max Barskih", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-26', title: "Вітрила", artist: "Melovin", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-27', title: "Кожний раз", artist: "MONATIK", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-28', title: "Промінь", artist: "MOZGI", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-29', title: "Обіцяю", artist: "NK/Настя Каменських", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-30', title: "Почуття", artist: "NK/Настя Каменських", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-31', title: "Тримай", artist: "NK/Настя Каменських", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-32', title: "Точка G", artist: "On i Ona", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-33', title: "Плакала Калина", artist: "POLINA DASHKOVA", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-34', title: "Вишиваночка", artist: "Selfy", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-35', title: "Галя балувана", artist: "Selfy", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-36', title: "Біля Тополі", artist: "Shumei", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-37', title: "Буревіями", artist: "Shumei & Злата Огнєвіч", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-38', title: "Я кохана дружина", artist: "Skalnystka", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-39', title: "Любий, кохай мене", artist: "SMS", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-40', title: "Чайки", artist: "SUNGUNS", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-41', title: "Квітка", artist: "TAYANNA", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-42', title: "Леля", artist: "TAYANNA", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-43', title: "Фантастична жiнка", artist: "TAYANNA", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-44', title: "Шкода", artist: "TAYANNA", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-45', title: "Жива", artist: "THE HARDKISS", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-46', title: "Журавлi", artist: "THE HARDKISS", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-47', title: "Прірва", artist: "THE HARDKISS", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-48', title: "Саме ти", artist: "VAHA", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-49', title: "ГОП-ГОП-ГОП", artist: "VERKA SERDUCHKA", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-50', title: "Вишні", artist: "Wellboy", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-51', title: "Гуси", artist: "Wellboy", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-52', title: "Додому", artist: "Wellboy", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-53', title: "Погляд", artist: "YAKTAK feat. SOBOL", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-54', title: "Живи", artist: "YULIYA ROZNEN", category: "Українські", subcategory: "Поп" },

            { id: 'ukr-pop-55', title: "Волошковий цвіт", artist: "Аліна Жук", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-56', title: "Пірнай", artist: "Альоша & Дарвін", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-57', title: "Ні я не ту кохав", artist: "Анатолій Говорадло", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-58', title: "Бред Пітт", artist: "Андріана", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-59', title: "Ой, мамо, не лайте", artist: "Андріана", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-60', title: "Зірочка палай", artist: "Анна Трінчер", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-61', title: "Лише тебе", artist: "Анна Трінчер", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-62', title: "Лише ти і я ", artist: "Анна Трінчер & Voloshyn", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-63', title: "Буде син", artist: "Антитіла", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-64', title: "Все красиво", artist: "Антитіла", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-65', title: "Джеральдіна", artist: "Арсен Мірзоян", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-66', title: "Дежавю", artist: "Артем Пивоваров", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-67', title: "Рандеву", artist: "Артем Пивоваров", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-68', title: "Думи", artist: "Артем Пивоваров & Dorofeeva", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-69', title: "Зорі запалали", artist: "БЕZ ОБМЕЖЕНЬ", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-70', title: "Листопад", artist: "БЕZ ОБМЕЖЕНЬ", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-71', title: "Тону", artist: "БЕZ ОБМЕЖЕНЬ", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-72', title: "Скажи мені", artist: "Бородін Максим", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-73', title: "Якби не ти", artist: "Бородін Максим", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-74', title: "Гойра вісілє", artist: "Василь Мельникович", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-75', title: "Хлопці будем жити", artist: "Василь Хлистун", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-76', title: "Чорна гора", artist: "Вася Club", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-77', title: "Котику", artist: "ВІА ТоШоНаДо", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-78', title: "Весілля в Карпатах", artist: "Віктор Павлік", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-79', title: "Нема з ким", artist: "Віктор Павлік", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-80', title: "Ні обіцянок, ні пробачень", artist: "Віктор Павлік", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-81', title: "Теща, дай", artist: "Віктор Павлік", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-82', title: "Ти подобаєшся мені", artist: "Віктор Павлік", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-83', title: "Шикидим", artist: "Віктор Павлік", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-84', title: "Я піду в далекі гори", artist: "Віктор Павлік", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-85', title: "Пінаколада", artist: "Віталій Козловський", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-86', title: "Люблю тебе", artist: "Віталій Лобач", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-87', title: "Iрка", artist: "Владислав Левицький", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-88', title: "Дим", artist: "Время и Стекло", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-89', title: "Самотня боса", artist: "Гайтана", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-90', title: "Поведи мене", artist: "Гурт Будьмо", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-91', title: "Причарувала", artist: "Гурт Будьмо", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-92', title: "Солодка Кара", artist: "Злата Огнєвіч", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-93', title: "Танцювати", artist: "Злата Огнєвіч", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-94', title: "А липи цвітуть", artist: "Іво Бобул", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-95', title: "Розмова з тобою", artist: "Іво Бобул", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-96', title: "Білі троянди", artist: "Ірина Федишин", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-97', title: "Калина", artist: "Ірина Федишин", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-98', title: "Сама п’ю, сама наливаю", artist: "Марина і компанія", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-99', title: "Тече вода", artist: "Марія Яремчук", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-100', title: "Наречена", artist: "Михайло Хома", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-101', title: "Ми будемо разом", artist: "Монте Крісто", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-102', title: "Сину, ангел мій", artist: "Надія Шестак", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-103', title: "Дівчина-весна", artist: "Наталія Бучинська", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-104', title: "Жоржини", artist: "Наталія Бучинська", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-105', title: "Карпати", artist: "Наталія Бучинська", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-106', title: "Романтично", artist: "Нікіта Кісельов", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-107', title: "Без тебе", artist: "Океан Ельзи", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-108', title: "На небі", artist: "Океан Ельзи", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-109', title: "Не йди", artist: "Океан Ельзи", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-110', title: "Все пробачати", artist: "Оксана Муха & Dan Balan", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-111', title: "Вовчиця", artist: "Олег Винник", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-112', title: "Наталі", artist: "Олег Винник", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-113', title: "Полон", artist: "Олег Винник", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-114', title: "Доню моя", artist: "Олександр Пономарьов", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-115', title: "Happy end (українська версія)", artist: "Пара Нормальних", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-116', title: "Вона", artist: "Плач Єремії", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-117', title: "На щастя", artist: "Потап & Олег Винник", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-118', title: "Найкращий день", artist: "Потап & Олег Винник", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-119', title: "Свят! Свят! Свят!", artist: "Потап & Олег Винник & Оля Полякова", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-120', title: "Мамо, я закохався", artist: "Роман Скорпіон", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-121', title: "Поцілую", artist: "Роман Скорпіон", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-122', title: "Фата", artist: "Роман Скорпіон", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-123', title: "Коломийка", artist: "Руслана", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-124', title: "Вона знає", artist: "Сергій Бабкін", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-125', title: "Де би я", artist: "Сергій Бабкін", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-126', title: "Пробач", artist: "Сергій Бабкін", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-127', title: "Люди, як кораблі", artist: "Скрябін", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-128', title: "Мам", artist: "Скрябін", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-129', title: "Місця щасливих людей", artist: "Скрябін", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-130', title: "Спи собі сама", artist: "Скрябін", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-131', title: "Шампанські очі", artist: "Скрябін", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-132', title: "Мій рідний край", artist: "Софія Ротару", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-133', title: "Одна калина", artist: "Софія Ротару", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-134', title: "Пісня буде поміж нас", artist: "Софія Ротару", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-135', title: "Червона Рута", artist: "Софія Ротару", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-136', title: "Цей сон", artist: "Степан Гіга", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-137', title: "Бiлi троянди", artist: "ТIК", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-138', title: "Біла хмара, чорна хмара", artist: "ТІК", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-139', title: "Не Дощ", artist: "Тіна Кароль", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-140', title: "Ніжно", artist: "Тіна Кароль", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-141', title: "Перечекати", artist: "Тіна Кароль", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-142', title: "Вільна", artist: "Тіна Кароль & Юлія Саніна", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-143', title: "Кульбаби", artist: "Тоня Матвієнко", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-144', title: "Українська лють", artist: "Христина Соловій", category: "Українські", subcategory: "Поп" },
            { id: 'ukr-pop-145', title: "Баби, як баби", artist: "Цвіт Кульбаби", category: "Українські", subcategory: "Поп" },


            // Українські - Рок
            { id: 'ukr-rock-1', title: "Розслабся, не парся", artist: "Mad Heads", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-2', title: "Кораблi", artist: "THE HARDKISS", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-3', title: "Прiрва", artist: "THE HARDKISS", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-4', title: "Кобра", artist: "THE HARDKISS & MONATIK", category: "Українські", subcategory: "Рок" },

            { id: 'ukr-rock-5', title: "Без неї ніяк", artist: "БЕZ ОБМЕЖЕНЬ", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-6', title: "Буду з тобою", artist: "БЕZ ОБМЕЖЕНЬ", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-7', title: "Було не любити", artist: "Брати Гадюкіни", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-8', title: "Файне місто Тернопіль", artist: "Брати Гадюкіни", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-9', title: "Весна", artist: "Воплі Відоплясова", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-10', title: "День НароDJення", artist: "Воплі Відоплясова", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-11', title: "Воїни світла UA", artist: "Ляпис Трубецкой", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-12', title: "Без бою", artist: "Океан Ельзи", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-13', title: "Зелені очі", artist: "Океан Ельзи", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-14', title: "Майже весна", artist: "Океан Ельзи", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-15', title: "Там, де нас нема", artist: "Океан Ельзи", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-16', title: "Люди як кораблі", artist: "Скрябін", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-17', title: "Маршрутка", artist: "Скрябін", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-18', title: "Сам собі країна", artist: "Скрябін", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-19', title: "Старі фотографії", artist: "Скрябін", category: "Українські", subcategory: "Рок" },
            { id: 'ukr-rock-20', title: "Їхали козаки", artist: "Тінь Сонця", category: "Українські", subcategory: "Рок" },

            // Зарубіжні - Поп
            { id: 'for-pop-1', title: "Gimme Gimme", artist: "ABBA", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-2', title: "Easy On Me", artist: "Adele", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-3', title: "Hafanana", artist: "Afric Simone", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-4', title: "No Roots", artist: "Alice Merton", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-5', title: "Friend", artist: "Aura Dione", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-6', title: "Zucchero", artist: "Baila Morena", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-7', title: "Bad Guy", artist: "Billie Eilish", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-8', title: "Sunny", artist: "Boney M.", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-9', title: "Havana", artist: "Camilla Cabello", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-10', title: "Safe And Sound", artist: "Capital Cities", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-11', title: "Sub Pielea Mea (Eroina)", artist: "Carla's Dreams", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-12', title: "Cause You Are Young", artist: "CC Catch", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-13', title: "Get Lucky", artist: "Daft Punk &. Pharrell Williams", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-14', title: "Allegro Ventigo", artist: "Dan Balan", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-15', title: "Numa Numa 2", artist: "Dan Balan", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-16', title: "Cake By The Ocean", artist: "DNCE", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-17', title: "Levitating", artist: "Dua Lipa", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-18', title: "Physical", artist: "Dua Lipa", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-19', title: "Sorry Seems To Be The Hardest Word", artist: "Elton John", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-20', title: "DUELE EL CORAZON", artist: "Enrique Iglesias", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-21', title: "Worth It", artist: "Fifth Harmony &. Kid Ink", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-22', title: "L.O.V.E.", artist: "Frank Sinatra", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-23', title: "Can't Take My Eyes Off You", artist: "Frank Sinatra", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-24', title: "I will Survive", artist: "Gloria Gaynor", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-25', title: "Be Good", artist: "Gregory Porter", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-26', title: "I Feel Good", artist: "James Brown", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-27', title: "Let’s Get Loud", artist: "Jennifer Lopez", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-28', title: "My Father’s Son", artist: "Joe Cocker", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-29', title: "Give Me Your Love ", artist: "John Newman", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-30', title: "La Camisa Negra", artist: "Juanes", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-31', title: "Can’t Stop the Feeling", artist: "Justin Timberlake", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-32', title: "Bella ciao", artist: "La Casa De Papel", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-33', title: "Shallow", artist: "Lady Gaga & Bradley Cooper", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-34', title: "Hello", artist: "Lionel Richie", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-35', title: "Despacito", artist: "Luis Fonsi", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-36', title: "So Long", artist: "Malfa", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-37', title: "Corazon", artist: "Maluma", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-38', title: "Uptown Funk", artist: "Mark Ronson ft. Bruno Mars", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-39', title: "Sugar", artist: "Maroon 5", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-40', title: "This Love", artist: "Maroon 5", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-41', title: "Żono moja", artist: "Masters", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-42', title: "Feeling Good", artist: "Michael Bubble", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-43', title: "Sway", artist: "Michael Bubble", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-44', title: "Ai Se Eu Te Pego (Nosa Nosa)", artist: "Michel Teló", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-45', title: "Flowers", artist: "Miley Cyrus", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-46', title: "Ram Pam Pam", artist: "Minelli", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-47', title: "Chery Chery Lady", artist: "Modern Talking", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-48', title: "You're My Heart, You're My Soul", artist: "Modern Talking", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-49', title: "Coco Jamboo", artist: "Mr. President", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-50', title: "Be Mine", artist: "Ofenbach", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-51', title: "Happy", artist: "Pharrell Williams", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-52', title: "In The Dark", artist: "Purple Disco Machine", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-53', title: "Hit The Road Jack", artist: "Ray Charles", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-54', title: "Let You Love Me", artist: "Rita Ora", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-55', title: "Disko Partizani", artist: "Shantel", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-56', title: "Señorita", artist: "Shawn Mendes & Camila Cabello", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-57', title: "Venus", artist: "Shocking Blue", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-58', title: "Isn’t She Lovely", artist: "Stevie Wonder", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-59', title: "Every Breath You Take", artist: "Sting", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-60', title: "Shape of My Heart", artist: "Sting", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-61', title: "Blinding Lights", artist: "The Weeknd", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-62', title: "Don’t Be Shy", artist: "Tiesto & Karol G", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-63', title: "Simply the Best", artist: "Tina Turner", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-64', title: "Sex Bomb", artist: "Tom Jones", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-65', title: "Dance Monkey", artist: "TONES AND I", category: "Зарубіжні", subcategory: "Поп" },
            { id: 'for-pop-66', title: "Hey Nah Nah Nah", artist: "Vaya Con Dios", category: "Зарубіжні", subcategory: "Поп" },


            // Зарубіжні - Рок
            { id: 'for-rock-1', title: "Highway to Hell", artist: "AC/DC", category: "Зарубіжні", subcategory: "Рок" },
            { id: 'for-rock-2', title: "Song 2", artist: "Blur", category: "Зарубіжні", subcategory: "Рок" },
            { id: 'for-rock-3', title: "It's my Life", artist: "Bon Jovi", category: "Зарубіжні", subcategory: "Рок" },
            { id: 'for-rock-4', title: "Johnny B. Goode", artist: "Chuck Berry", category: "Зарубіжні", subcategory: "Рок" },
            { id: 'for-rock-5', title: "Adventure of a Lifetime", artist: "Coldplay", category: "Зарубіжні", subcategory: "Рок" },
            { id: 'for-rock-6', title: "Smoke On the Water", artist: "Deep Purple", category: "Зарубіжні", subcategory: "Рок" },
            { id: 'for-rock-7', title: "Jailhouse Rock", artist: "Elvis Presley", category: "Зарубіжні", subcategory: "Рок" },
            { id: 'for-rock-8', title: "Hero", artist: "Enrique Iglesias", category: "Зарубіжні", subcategory: "Рок" },
            { id: 'for-rock-9', title: "Sweet Dreams", artist: "Eurythmics", category: "Зарубіжні", subcategory: "Рок" },
            { id: 'for-rock-10', title: "I Love Rock 'n’ Roll", artist: "Joan Jett", category: "Зарубіжні", subcategory: "Рок" },
            { id: 'for-rock-11', title: "Way Down We Go", artist: "KALEO", category: "Зарубіжні", subcategory: "Рок" },
            { id: 'for-rock-12', title: "Smells Like Teen Spirit", artist: "Nirvana", category: "Зарубіжні", subcategory: "Рок" },
            { id: 'for-rock-13', title: "Bohemian Rhapsody", artist: "Queen", category: "Зарубіжні", subcategory: "Рок" },
            { id: 'for-rock-14', title: "Show Must Go On", artist: "Queen", category: "Зарубіжні", subcategory: "Рок" },
            { id: 'for-rock-15', title: "Somebody Told Me", artist: "The Killers", category: "Зарубіжні", subcategory: "Рок" },
            { id: 'for-rock-16', title: "Seven Nation Army", artist: "The White Stripes", category: "Зарубіжні", subcategory: "Рок" },

    ];

    const MAX_SONGS = 50;
    const selectedSongsSection = document.getElementById('selectedSongsSection');
    const scrollButton = document.getElementById('scrollButton');
    const searchInput = document.getElementById('searchInput');
    const songList = document.getElementById('songList');
    const selectedListContainer = document.getElementById('selectedListContainer');
    const selectedCounterTop = document.getElementById('selectedCounterTop');
    const selectedCounterBottom = document.getElementById('selectedCounterBottom');
    const copyButton = document.getElementById('copyButton');
    const undoButton = document.getElementById('undoButton');
    const emptySelectedMessage = document.getElementById('emptySelectedMessage');

    let selectedSongs = JSON.parse(localStorage.getItem('selectedSongs')) || [];
    let history = [];

    scrollButton.addEventListener('click', () => {
        selectedSongsSection.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
        });
    });

    function getStyleIcon(style) {
        switch (style) {
            case 'Народні': return `<i class="fa-solid fa-guitar icon text-yellow-500"></i>`;
            case 'Поп': return `<i class="fa-solid fa-microphone icon text-pink-500"></i>`;
            case 'Рок': return `<i class="fa-solid fa-drum icon text-red-500"></i>`;
            default: return '';
        }
    }

    function renderSongList(filter = '') {
        songList.innerHTML = '';
        const filteredSongs = allSongs.filter(song =>
            song.title.toLowerCase().includes(filter.toLowerCase()) ||
            song.artist.toLowerCase().includes(filter.toLowerCase())
        );

        const groupedSongs = allSongs.reduce((acc, song) => {
            if (!acc[song.category]) acc[song.category] = {};
            if (!acc[song.category][song.subcategory]) acc[song.category][song.subcategory] = [];
            acc[song.category][song.subcategory].push(song);
            return acc;
        }, {});

        let html = '';
        const categories = Object.keys(groupedSongs);
        categories.forEach(category => {
            html += `<h2 class="text-3xl font-bold mt-8 mb-4 text-amber-600">${category}</h2>`;
            const subcategories = Object.keys(groupedSongs[category]);
            subcategories.forEach(subcategory => {
                html += `<h3 class="text-2xl font-semibold mt-6 mb-3 text-gray-700 flex items-center">${subcategory}${getStyleIcon(subcategory)}</h3>`;

                const subcategorySongs = groupedSongs[category][subcategory];
                const sortedSubcategorySongs = [...subcategorySongs].sort((a, b) => {
                    const aHighlighted = filteredSongs.some(s => s.id === a.id);
                    const bHighlighted = filteredSongs.some(s => s.id === b.id);
                    if (aHighlighted && !bHighlighted) return -1;
                    if (!aHighlighted && bHighlighted) return 1;
                    return 0;
                });

                sortedSubcategorySongs.forEach(song => {
                    const isSelected = selectedSongs.some(s => s.id === song.id);
                    const isHighlighted = filteredSongs.some(s => s.id === song.id) && filter.length > 0;
                    const itemClass = `song-item flex items-center bg-white shadow-sm transition-all duration-200 hover:bg-gray-100 ${isSelected ? 'selected opacity-50' : ''} ${isHighlighted ? 'highlighted' : ''}`;
                    const checkboxClass = `custom-checkbox ${isSelected ? 'checked bg-amber-500' : 'bg-gray-100'}`;

                    html += `
                        <div class="${itemClass}" data-song-id="${song.id}">
                            <div class="${checkboxClass}"></div>
                            <div class="flex-1">
                                <span class="font-medium text-lg">${song.title}</span>
                                <span class="text-sm text-gray-500 block">${song.artist}</span>
                            </div>
                        </div>
                    `;
                });
            });
        });
        songList.innerHTML = html;
    }

    function renderSelectedList() {
        selectedListContainer.innerHTML = '';
        if (selectedSongs.length === 0) {
            emptySelectedMessage.classList.remove('hidden');
            return;
        } else {
            emptySelectedMessage.classList.add('hidden');
        }

        const groupedSelected = selectedSongs.reduce((acc, song) => {
            if (!acc[song.category]) acc[song.category] = {};
            if (!acc[song.category][song.subcategory]) acc[song.category][song.subcategory] = [];
            acc[song.category][song.subcategory].push(song);
            return acc;
        }, {});

        let html = '';
        let counter = 1;

        const categories = Object.keys(groupedSelected);
        categories.forEach(category => {
            html += `<h3 class="text-2xl font-bold mt-6 mb-3 text-gray-700">${category}</h3>`;
            const subcategories = Object.keys(groupedSelected[category]);
            subcategories.forEach(subcategory => {
                html += `<p class="text-xl font-medium mt-4 mb-2 text-gray-600 flex items-center">${subcategory}${getStyleIcon(subcategory)}</p>`;
                groupedSelected[category][subcategory].forEach(song => {
                    const checkboxClass = 'custom-checkbox checked bg-amber-500';
                    html += `
                        <div class="song-item selected flex items-center bg-gray-100 shadow-sm transition-all duration-200 hover:bg-gray-200" data-song-id="${song.id}">
                            <div class="${checkboxClass}"></div>
                            <div class="flex-1 flex items-start">
                                <span class="font-medium text-lg mr-2">${counter}.</span>
                                <div>
                                    <span class="font-medium text-lg">${song.title}</span>
                                    <span class="text-sm text-gray-500 block">${song.artist}</span>
                                </div>
                            </div>
                        </div>
                    `;
                    counter++;
                });
            });
        });

        selectedListContainer.innerHTML = html;
    }

    function updateCounters() {
        const count = selectedSongs.length;
        const counterSpanTop = selectedCounterTop.querySelector('span:first-child');
        const counterSpanBottom = selectedCounterBottom.querySelector('span:first-child');

        counterSpanTop.textContent = count;
        selectedCounterBottom.textContent = `${count}/${MAX_SONGS}`;

        if (count > MAX_SONGS) {
            selectedCounterTop.classList.add('counter-red');
            scrollButton.classList.add('bg-red-500');
            scrollButton.classList.remove('bg-amber-500');
        } else {
            selectedCounterTop.classList.remove('counter-red');
            scrollButton.classList.remove('bg-red-500');
            scrollButton.classList.add('bg-amber-500');
        }

        if (history.length > 0) {
            undoButton.disabled = false;
            undoButton.classList.remove('opacity-50');
        } else {
            undoButton.disabled = true;
            undoButton.classList.add('opacity-50');
        }
    }

    function handleSongSelection(songId, isSelected) {
        const song = allSongs.find(s => s.id === songId);
        if (isSelected) {
            selectedSongs.push(song);
            history.push({ action: 'add', songId: songId });
        } else {
            selectedSongs = selectedSongs.filter(s => s.id !== songId);
            history.push({ action: 'remove', songId: songId });
        }
        localStorage.setItem('selectedSongs', JSON.stringify(selectedSongs));
        renderSongList(searchInput.value);
        renderSelectedList();
        updateCounters();
    }

    function copyList() {
        let textToCopy = `Обрані пісні (${selectedSongs.length}/${MAX_SONGS}):\n\n`;
        let counter = 1;

        const groupedSelected = selectedSongs.reduce((acc, song) => {
            if (!acc[song.category]) acc[song.category] = {};
            if (!acc[song.category][song.subcategory]) acc[song.category][song.subcategory] = [];
            acc[song.category][song.subcategory].push(song);
            return acc;
        }, {});

        Object.keys(groupedSelected).forEach(category => {
            textToCopy += `--- ${category} ---\n`;
            Object.keys(groupedSelected[category]).forEach(subcategory => {
                textToCopy += `**${subcategory}**\n`;
                groupedSelected[category][subcategory].forEach(song => {
                    textToCopy += `${counter}. ${song.title} - ${song.artist}\n`;
                    counter++;
                });
            });
        });

        const tempTextArea = document.createElement('textarea');
        tempTextArea.value = textToCopy;
        document.body.appendChild(tempTextArea);
        tempTextArea.select();
        document.execCommand('copy');
        document.body.removeChild(tempTextArea);

        copyButton.textContent = 'Скопійовано!';
        setTimeout(() => {
            copyButton.textContent = 'Скопіювати список';
        }, 2000);
    }

    function undoLastAction() {
        if (history.length > 0) {
            const lastAction = history.pop();
            const songId = lastAction.songId;
            const song = allSongs.find(s => s.id === songId);

            if (lastAction.action === 'add') {
                selectedSongs = selectedSongs.filter(s => s.id !== songId);
            } else if (lastAction.action === 'remove') {
                if (song) {
                    selectedSongs.push(song);
                }
            }

            localStorage.setItem('selectedSongs', JSON.stringify(selectedSongs));
            renderSongList(searchInput.value);
            renderSelectedList();
            updateCounters();
        }
    }

    searchInput.addEventListener('input', (e) => renderSongList(e.target.value));
    songList.addEventListener('click', (e) => {
        const songItem = e.target.closest('.song-item');
        if (songItem) {
            const songId = songItem.dataset.songId;
            const isSelected = selectedSongs.some(s => s.id === songId);
            handleSongSelection(songId, !isSelected);
        }
    });

    selectedListContainer.addEventListener('click', (e) => {
        const songItem = e.target.closest('.song-item');
        if (songItem) {
            const songId = songItem.dataset.songId;
            handleSongSelection(songId, false);
        }
    });

    copyButton.addEventListener('click', copyList);
    undoButton.addEventListener('click', undoLastAction);

    renderSongList();
    renderSelectedList();
    updateCounters();
</script>

</body>
</html>